
sudo apt install default-jdk
sudo apt install scala -y
scala -version
https://dlcdn.apache.org/spark/spark-3.5.3/spark-3.5.3-bin-hadoop3.tgz  --in chrome
ls
tar -xvf spark-3.5.3-bin-hadoop3.tgz
sudo mv spark-3.5.3-bin-hadoop3 /opt/spark
nano ~/.bashrc  -#after this insert this three line-

export JAVA_HOME=/usr/lib/jvm/java-21-openjdk-amd64 -#check version of java
export SPARK_HOME=/opt/spark
export PATH=$SPARK_HOME/bin:$PATH

source ~/.bashrc
spark-shell
cat >> bharani.txt #any file name
i am tharkuri thank i am bharani #text
val inputfile = sc.textFile("bharani.txt")

scala> val counts = inputfile.flatMap(line=>line.split(" ")).map(word => (word,1)).reduceByKey(_+_)
scala> counts.saveAsTextFile("output1")
# get out of scala
cat output1.txt
cd output1
ls
 cat part-00000
